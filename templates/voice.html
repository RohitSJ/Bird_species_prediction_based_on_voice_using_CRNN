{% extends "base.html" %}

{% block content %}
<style>
    /* Main Styles */
    .voice-header {
        background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
        color: white;
        padding: 1.5rem;
        border-radius: 12px;
        margin-bottom: 2rem;
        box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        animation: fadeInDown 0.8s ease;
    }
    
    .voice-header h1 {
        margin: 0;
        font-size: 2.2rem;
        font-weight: 700;
        text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
    }
    
    .back-btn {
        background: rgba(255,255,255,0.2);
        border: none;
        transition: all 0.3s ease;
        font-weight: 600;
    }
    
    .back-btn:hover {
        background: rgba(255,255,255,0.3);
        transform: translateX(-3px);
    }
    
    .upload-card {
        background: white;
        border-radius: 15px;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: 0 8px 30px rgba(0,0,0,0.08);
        border: none;
        animation: fadeIn 0.8s ease 0.2s both;
        position: relative;
        overflow: hidden;
    }
    
    .upload-card::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 5px;
        background: linear-gradient(90deg, #6a11cb 0%, #2575fc 100%);
    }
    
    /* File Upload Styles */
    .file-upload {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 2rem;
        border: 2px dashed #bdc3c7;
        border-radius: 12px;
        margin-bottom: 1.5rem;
        transition: all 0.3s ease;
        background: #f9f9f9;
    }
    
    .file-upload:hover {
        border-color: #6a11cb;
        background: #f1f1f1;
    }
    
    .file-upload input {
        display: none;
    }
    
    /* NEW: File upload buttons container */
    .file-upload-buttons {
        display: flex;
        gap: 15px;
        margin-bottom: 1.5rem;
        flex-wrap: wrap;
        justify-content: center;
    }
    
    .file-upload label {
        padding: 12px 24px;
        background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
        color: white;
        border-radius: 30px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(106, 17, 203, 0.3);
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .file-upload label:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(106, 17, 203, 0.4);
    }
    
    /* NEW: Microphone button styles */
    .mic-button {
        padding: 12px 24px;
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
        border-radius: 30px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        display: flex;
        align-items: center;
        gap: 8px;
        border: none;
    }
    
    .mic-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
    }
    
    .mic-button.recording {
        background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
        animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
        0% {
            box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.4);
        }
        70% {
            box-shadow: 0 0 0 10px rgba(220, 53, 69, 0);
        }
        100% {
            box-shadow: 0 0 0 0 rgba(220, 53, 69, 0);
        }
    }
    
    /* NEW: Audio visualization styles */
    .audio-visualizer {
        width: 100%;
        height: 100px;
        background-color: #f8f9fa;
        border-radius: 8px;
        margin-bottom: 1.5rem;
        position: relative;
        overflow: hidden;
        display: none;
        border: 2px solid #6a11cb;
    }
    
    .audio-visualizer canvas {
        width: 100%;
        height: 100%;
        display: block;
    }
    
    .recording-timer {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: bold;
    }
    
    /* NEW: Audio player styles */
    .audio-player {
        margin-top: 1rem;
        width: 100%;
        display: none;
    }
    
    .audio-player audio {
        width: 100%;
        border-radius: 8px;
    }
    
    /* Results Section */
    .result-section {
        display: none;
        background: white;
        border-radius: 15px;
        padding: 2rem;
        margin-top: 2rem;
        box-shadow: 0 8px 30px rgba(0,0,0,0.08);
        animation: fadeInUp 0.8s ease;
    }
    
    .prediction-card {
        background: linear-gradient(135deg, rgba(106, 17, 203, 0.05) 0%, rgba(37, 117, 252, 0.05) 100%);
        padding: 1.5rem;
        border-radius: 12px;
        margin-bottom: 2rem;
        border-left: 4px solid #6a11cb;
    }
    
    /* Wikipedia Info Styles */
    .bird-details-container {
        display: flex;
        flex-wrap: wrap;
        gap: 2rem;
        margin-top: 2rem;
    }
    
    .bird-image-container {
        flex: 1;
        min-width: 300px;
    }
    
    .bird-image {
        width: 100%;
        max-height: 400px;
        object-fit: contain;
        border-radius: 12px;
        box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        animation: fadeIn 0.8s ease;
    }
    
    .bird-info {
        flex: 2;
        min-width: 300px;
    }
    
    .bird-info h3 {
        color: #2c3e50;
        margin-bottom: 1rem;
        border-bottom: 2px solid #6a11cb;
        padding-bottom: 0.5rem;
    }
    
    .bird-description {
        color: #34495e;
        line-height: 1.6;
    }
    
    .wiki-attribution {
        font-size: 0.8rem;
        color: #7f8c8d;
        margin-top: 1rem;
        text-align: right;
    }
    
    /* Scientific Info Styles */
    .scientific-info {
        background: #f8f9fa;
        border-radius: 12px;
        padding: 1.5rem;
        margin-top: 2rem;
        border-left: 4px solid #2575fc;
    }
    
    .scientific-info h3 {
        color: #2c3e50;
        margin-bottom: 1rem;
        border-bottom: 2px solid #2575fc;
        padding-bottom: 0.5rem;
    }
    
    .classification-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 1rem;
    }
    
    .classification-table th {
        background: #e9ecef;
        padding: 0.75rem;
        text-align: left;
    }
    
    .classification-table td {
        padding: 0.75rem;
        border-bottom: 1px solid #dee2e6;
    }
    
    .classification-table tr:last-child td {
        border-bottom: none;
    }
    
    /* Animations */
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    @keyframes fadeInDown {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    /* Loading Spinner */
    .loading {
        display: none;
        text-align: center;
        margin: 2rem 0;
    }
    
    .spinner {
        border: 5px solid rgba(106, 17, 203, 0.1);
        border-top: 5px solid #6a11cb;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
        margin: 0 auto 1rem;
    }
    
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    /* Responsive Adjustments */
    @media (max-width: 768px) {
        .bird-details-container {
            flex-direction: column;
        }
        
        .bird-image-container, .bird-info {
            min-width: 100%;
        }
        
        .file-upload-buttons {
            flex-direction: column;
            align-items: center;
        }
    }
</style>

<div class="voice-header d-flex justify-content-between align-items-center">
    <h1>üé§ Bird Voice Identification</h1>
    <a href="{{ url_for('home') }}" class="btn back-btn">‚Üê Back to Main Menu</a>
</div>

<div class="upload-card">
    <h5 class="card-title">Upload or Record Bird Sounds</h5>
    <p class="card-text">Record or upload bird vocalizations to identify the species. Our model analyzes the unique audio patterns.</p>
    
    <div class="file-upload">
        <!-- NEW: Updated buttons container -->
        <div class="file-upload-buttons">
            <label for="audioFile">
                <i class="bi bi-file-earmark-music"></i> Choose Audio File
            </label>
            <!-- NEW: Microphone button -->
            <button id="recordButton" class="mic-button">
                <i class="bi bi-mic"></i> <span id="recordButtonText">Record Audio</span>
            </button>
        </div>
        
        <input type="file" id="audioFile" accept=".wav,.mp3,.flac">
        <div class="file-name" id="fileName">No file selected</div>
        
        <!-- NEW: Audio visualizer -->
        <div class="audio-visualizer" id="audioVisualizer">
            <canvas id="visualizer"></canvas>
            <div class="recording-timer" id="recordingTimer">00:00</div>
        </div>
        
        <!-- NEW: Audio player for preview -->
        <div class="audio-player" id="audioPlayer">
            <audio id="audioPreview" controls></audio>
        </div>
    </div>
    
    <button id="predictButton" class="btn btn-success btn-lg mt-3" disabled>
        <i class="bi bi-search"></i> Identify Bird
    </button>
</div>

<div class="loading" id="loadingIndicator">
    <div class="spinner"></div>
    <p>Analyzing the audio patterns...</p>
</div>

<div class="result-section" id="resultSection">
    <h2>Prediction Result</h2>
    
    <div class="prediction-card">
        <h3 id="predictionResult">Bird Species</h3>
        <p>Confidence: <span id="confidenceValue">0%</span></p>
        <div class="progress">
            <div class="progress-bar" id="confidenceLevel" role="progressbar" style="width: 0%"></div>
        </div>
    </div>
    
    <div class="other-predictions">
        <h3>Other Possible Matches</h3>
        <div id="allPredictions"></div>
    </div>
    
    <div class="bird-details-container" id="birdDetails">
        <!-- Wikipedia content will be loaded here -->
    </div>
    
    <div class="scientific-info" id="scientificInfo">
        <!-- JSON bird data will be loaded here -->
    </div>
</div>

<script>
    // Define the bird data from the JSON (keeping your existing data)
    const birdData = [
        {
      "Common Name": "Ashy Prinia",
      "Scientific Name": "Prinia socialis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Cisticolidae",
        "Genus": "Prinia",
        "Species": "P. socialis"
      }
    },
    {
      "Common Name": "Ashy-Crowned Sparrow-Lark",
      "Scientific Name": "Eremopterix griseus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Alaudidae",
        "Genus": "Eremopterix",
        "Species": "E. griseus"
      }
    },
    {
      "Common Name": "Asian Brown Flycatcher",
      "Scientific Name": "Muscicapa dauurica",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Muscicapidae",
        "Genus": "Muscicapa",
        "Species": "M. dauurica"
      }
    },
    {
      "Common Name": "Asian Koel",
      "Scientific Name": "Eudynamys scolopaceus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Cuculiformes",
        "Family": "Cuculidae",
        "Genus": "Eudynamys",
        "Species": "E. scolopaceus"
      }
    },
    {
      "Common Name": "Asian Openbill",
      "Scientific Name": "Anastomus oscitans",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Ciconiiformes",
        "Family": "Ciconiidae",
        "Genus": "Anastomus",
        "Species": "A. oscitans"
      }
    },
    {
      "Common Name": "Barn Owl",
      "Scientific Name": "Tyto alba",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Strigiformes",
        "Family": "Tytonidae",
        "Genus": "Tyto",
        "Species": "T. alba"
      }
    },
    {
      "Common Name": "Barn Swallow",
      "Scientific Name": "Hirundo rustica",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Hirundinidae",
        "Genus": "Hirundo",
        "Species": "H. rustica"
      }
    },
    {
      "Common Name": "Baya Weaver",
      "Scientific Name": "Ploceus philippinus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Ploceidae",
        "Genus": "Ploceus",
        "Species": "P. philippinus"
      }
    },
    {
      "Common Name": "Bay-Backed Shrike",
      "Scientific Name": "Lanius vittatus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Laniidae",
        "Genus": "Lanius",
        "Species": "L. vittatus"
      }
    },
    {
      "Common Name": "Black Drongo",
      "Scientific Name": "Dicrurus macrocercus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Dicruridae",
        "Genus": "Dicrurus",
        "Species": "D. macrocercus"
      }
    },
    {
      "Common Name": "Black-Headed Ibis",
      "Scientific Name": "Threskiornis melanocephalus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Pelecaniformes",
        "Family": "Threskiornithidae",
        "Genus": "Threskiornis",
        "Species": "T. melanocephalus"
      }
    },
    {
      "Common Name": "Black-Hooded Oriole",
      "Scientific Name": "Oriolus xanthornus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Oriolidae",
        "Genus": "Oriolus",
        "Species": "O. xanthornus"
      }
    },
    {
      "Common Name": "Black-Lored Tit",
      "Scientific Name": "Machlolophus xanthogenys",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Paridae",
        "Genus": "Machlolophus",
        "Species": "M. xanthogenys"
      }
    },
    {
      "Common Name": "Black-Rumped Flameback",
      "Scientific Name": "Dinopium benghalense",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Picidae",
        "Genus": "Dinopium",
        "Species": "D. benghalense"
      }
    },
    {
      "Common Name": "Black-Throated Munia",
      "Scientific Name": "Lonchura kelaarti",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Estrildidae",
        "Genus": "Lonchura",
        "Species": "L. kelaarti"
      }
    },
    {
      "Common Name": "Black-Throated Sunbird",
      "Scientific Name": "Aethopyga saturata",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Nectariniidae",
        "Genus": "Aethopyga",
        "Species": "A. saturata"
      }
    },
    {
      "Common Name": "Black-Winged Kite",
      "Scientific Name": "Elanus caeruleus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Accipitriformes",
        "Family": "Accipitridae",
        "Genus": "Elanus",
        "Species": "E. caeruleus"
      }
    },
    {
      "Common Name": "Blue-Throated Barbet",
      "Scientific Name": "Psilopogon asiaticus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Megalaimidae",
        "Genus": "Psilopogon",
        "Species": "P. asiaticus"
      }
    },
    {
      "Common Name": "Booted Eagle",
      "Scientific Name": "Hieraaetus pennatus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Accipitriformes",
        "Family": "Accipitridae",
        "Genus": "Hieraaetus",
        "Species": "H. pennatus"
      }
    },
    {
      "Common Name": "Brahminy Kite",
      "Scientific Name": "Haliastur indus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Accipitriformes",
        "Family": "Accipitridae",
        "Genus": "Haliastur",
        "Species": "H. indus"
      }
    },
    {
      "Common Name": "Brown Shrike",
      "Scientific Name": "Lanius cristatus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Laniidae",
        "Genus": "Lanius",
        "Species": "L. cristatus"
      }
    },
    {
      "Common Name": "Brown-Capped Pygmy Woodpecker",
      "Scientific Name": "Yungipicus nanus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Picidae",
        "Genus": "Yungipicus",
        "Species": "Y. nanus"
      }
    },
    {
      "Common Name": "Brown-Fronted Woodpecker",
      "Scientific Name": "Dendrocopos auriceps",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Picidae",
        "Genus": "Dendrocopos",
        "Species": "D. auriceps"
      }
    },
    {
      "Common Name": "Brown-Headed Barbet",
      "Scientific Name": "Psilopogon zeylanicus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Megalaimidae",
        "Genus": "Psilopogon",
        "Species": "P. zeylanicus"
      }
    },
    {
      "Common Name": "Changeable Hawk-Eagle",
      "Scientific Name": "Nisaetus cirrhatus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Accipitriformes",
        "Family": "Accipitridae",
        "Genus": "Nisaetus",
        "Species": "N. cirrhatus"
      }
    },
    {
      "Common Name": "Chestnut Munia",
      "Scientific Name": "Lonchura atricapilla",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Estrildidae",
        "Genus": "Lonchura",
        "Species": "L. atricapilla"
      }
    },
    {
      "Common Name": "Chestnut-Bellied Nuthatch",
      "Scientific Name": "Sitta cinnamoventris",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Sittidae",
        "Genus": "Sitta",
        "Species": "S. cinnamoventris"
      }
    },
    {
      "Common Name": "Cinereous Tit",
      "Scientific Name": "Parus cinereus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Paridae",
        "Genus": "Parus",
        "Species": "P. cinereus"
      }
    },
    {
      "Common Name": "Common Babbler",
      "Scientific Name": "Turdoides caudata",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Leiothrichidae",
        "Genus": "Turdoides",
        "Species": "T. caudata"
      }
    },
    {
      "Common Name": "Common Flameback",
      "Scientific Name": "Dinopium javanense",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Picidae",
        "Genus": "Dinopium",
        "Species": "D. javanense"
      }
    },
    {
      "Common Name": "Common Kingfisher",
      "Scientific Name": "Alcedo atthis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Coraciiformes",
        "Family": "Alcedinidae",
        "Genus": "Alcedo",
        "Species": "A. atthis"
      }
    },
    {
      "Common Name": "Common Myna",
      "Scientific Name": "Acridotheres tristis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Sturnidae",
        "Genus": "Acridotheres",
        "Species": "A. tristis"
      }
    },
    {
      "Common Name": "Common Tailorbird",
      "Scientific Name": "Orthotomus sutorius",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Cisticolidae",
        "Genus": "Orthotomus",
        "Species": "O. sutorius"
      }
    },
    {
      "Common Name": "Coppersmith Barbet",
      "Scientific Name": "Psilopogon haemacephalus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Megalaimidae",
        "Genus": "Psilopogon",
        "Species": "P. haemacephalus"
      }
    },
    {
      "Common Name": "Crested Serpent Eagle",
      "Scientific Name": "Spilornis cheela",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Accipitriformes",
        "Family": "Accipitridae",
        "Genus": "Spilornis",
        "Species": "S. cheela"
      }
    },
    {
      "Common Name": "Crimson Sunbird",
      "Scientific Name": "Aethopyga siparaja",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Nectariniidae",
        "Genus": "Aethopyga",
        "Species": "A. siparaja"
      }
    },
    {
      "Common Name": "Dusky Crag Martin",
      "Scientific Name": "Ptyonoprogne concolor",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Hirundinidae",
        "Genus": "Ptyonoprogne",
        "Species": "P. concolor"
      }
    },
    {
      "Common Name": "Eurasian Collared Dove",
      "Scientific Name": "Streptopelia decaocto",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Columbiformes",
        "Family": "Columbidae",
        "Genus": "Streptopelia",
        "Species": "S. decaocto"
      }
    },
    {
      "Common Name": "Fire-Tailed Sunbird",
      "Scientific Name": "Aethopyga ignicauda",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Nectariniidae",
        "Genus": "Aethopyga",
        "Species": "A. ignicauda"
      }
    },
    {
      "Common Name": "Great Cormorant",
      "Scientific Name": "Phalacrocorax carbo",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Suliformes",
        "Family": "Phalacrocoracidae",
        "Genus": "Phalacrocorax",
        "Species": "P. carbo"
      }
    },
    {
      "Common Name": "Great Slaty Woodpecker",
      "Scientific Name": "Mulleripicus pulverulentus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Picidae",
        "Genus": "Mulleripicus",
        "Species": "M. pulverulentus"
      }
    },
    {
      "Common Name": "Greater Coucal",
      "Scientific Name": "Centropus sinensis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Cuculiformes",
        "Family": "Cuculidae",
        "Genus": "Centropus",
        "Species": "C. sinensis"
      }
    },
    {
      "Common Name": "Greater Flameback",
      "Scientific Name": "Chrysocolaptes lucidus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Picidae",
        "Genus": "Chrysocolaptes",
        "Species": "C. lucidus"
      }
    },
    {
      "Common Name": "Green Bee-Eater",
      "Scientific Name": "Merops orientalis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Coraciiformes",
        "Family": "Meropidae",
        "Genus": "Merops",
        "Species": "M. orientalis"
      }
    },
    {
      "Common Name": "Green-Tailed Sunbird",
      "Scientific Name": "Aethopyga nipalensis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Nectariniidae",
        "Genus": "Aethopyga",
        "Species": "A. nipalensis"
      }
    },
    {
      "Common Name": "Grey-Throated Martin",
      "Scientific Name": "Riparia chinensis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Hirundinidae",
        "Genus": "Riparia",
        "Species": "R. chinensis"
      }
    },
    {
      "Common Name": "Heart-Spotted Woodpecker",
      "Scientific Name": "Hemicircus canente",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Picidae",
        "Genus": "Hemicircus",
        "Species": "H. canente"
      }
    },
    {
      "Common Name": "Himalayan Flameback",
      "Scientific Name": "Dinopium shorii",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Picidae",
        "Genus": "Dinopium",
        "Species": "D. shorii"
      }
    },
    {
      "Common Name": "Himalayan Woodpecker",
      "Scientific Name": "Dendrocopos himalayensis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Picidae",
        "Genus": "Dendrocopos",
        "Species": "D. himalayensis"
      }
    },
    {
      "Common Name": "Hooded Pitta",
      "Scientific Name": "Pitta sordida",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Pittidae",
        "Genus": "Pitta",
        "Species": "P. sordida"
      }
    },
    {
      "Common Name": "House Crow",
      "Scientific Name": "Corvus splendens",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Corvidae",
        "Genus": "Corvus",
        "Species": "C. splendens"
      }
    },
    {
      "Common Name": "Indian Blue Robin",
      "Scientific Name": "Luscinia brunnea",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Muscicapidae",
        "Genus": "Luscinia",
        "Species": "L. brunnea"
      }
    },
    {
      "Common Name": "Indian Bush Lark",
      "Scientific Name": "Mirafra erythroptera",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Alaudidae",
        "Genus": "Mirafra",
        "Species": "M. erythroptera"
      }
    },
    {
      "Common Name": "Indian Golden Oriole",
      "Scientific Name": "Oriolus kundoo",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Oriolidae",
        "Genus": "Oriolus",
        "Species": "O. kundoo"
      }
    },
    {
      "Common Name": "Indian Grey Hornbill",
      "Scientific Name": "Ocyceros birostris",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Bucerotiformes",
        "Family": "Bucerotidae",
        "Genus": "Ocyceros",
        "Species": "O. birostris"
      }
    },
    {
      "Common Name": "Indian Nuthatch",
      "Scientific Name": "Sitta castanea",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Sittidae",
        "Genus": "Sitta",
        "Species": "S. castanea"
      }
    },
    {
      "Common Name": "Indian Paradise Flycatcher",
      "Scientific Name": "Terpsiphone paradisi",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Monarchidae",
        "Genus": "Terpsiphone",
        "Species": "T. paradisi"
      }
    },
    {
      "Common Name": "Indian Peafowl",
      "Scientific Name": "Pavo cristatus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Galliformes",
        "Family": "Phasianidae",
        "Genus": "Pavo",
        "Species": "P. cristatus"
      }
    },
    {
      "Common Name": "Indian Pitta",
      "Scientific Name": "Pitta brachyura",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Pittidae",
        "Genus": "Pitta",
        "Species": "P. brachyura"
      }
    },
    {
      "Common Name": "Indian Pond Heron",
      "Scientific Name": "Ardeola grayii",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Pelecaniformes",
        "Family": "Ardeidae",
        "Genus": "Ardeola",
        "Species": "A. grayii"
      }
    },
    {
      "Common Name": "Indian Robin",
      "Scientific Name": "Copsychus fulicatus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Muscicapidae",
        "Genus": "Copsychus",
        "Species": "C. fulicatus"
      }
    },
    {
      "Common Name": "Indian Roller",
      "Scientific Name": "Coracias benghalensis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Coraciiformes",
        "Family": "Coraciidae",
        "Genus": "Coracias",
        "Species": "C. benghalensis"
      }
    },
    {
      "Common Name": "Indian Scops Owl",
      "Scientific Name": "Otus bakkamoena",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Strigiformes",
        "Family": "Strigidae",
        "Genus": "Otus",
        "Species": "O. bakkamoena"
      }
    },
    {
      "Common Name": "Indian Silverbill",
      "Scientific Name": "Euodice malabarica",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Estrildidae",
        "Genus": "Euodice",
        "Species": "E. malabarica"
      }
    },
    {
      "Common Name": "Indian Skimmer",
      "Scientific Name": "Rynchops albicollis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Charadriiformes",
        "Family": "Laridae",
        "Genus": "Rynchops",
        "Species": "R. albicollis"
      }
    },
    {
      "Common Name": "Indian Spotted Eagle",
      "Scientific Name": "Clanga hastata",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Accipitriformes",
        "Family": "Accipitridae",
        "Genus": "Clanga",
        "Species": "C. hastata"
      }
    },
    {
      "Common Name": "Jerdon's Bush Lark",
      "Scientific Name": "Mirafra affinis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Alaudidae",
        "Genus": "Mirafra",
        "Species": "M. affinis"
      }
    },
    {
      "Common Name": "Jungle Babbler",
      "Scientific Name": "Argya striata",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Leiothrichidae",
        "Genus": "Argya",
        "Species": "A. striata"
      }
    },
    {
      "Common Name": "Large Grey Babbler",
      "Scientific Name": "Argya malcolmi",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Leiothrichidae",
        "Genus": "Argya",
        "Species": "A. malcolmi"
      }
    },
    {
      "Common Name": "Lesser Yellownape",
      "Scientific Name": "Picus chlorolophus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Picidae",
        "Genus": "Picus",
        "Species": "P. chlorolophus"
      }
    },
    {
      "Common Name": "Little Egret",
      "Scientific Name": "Egretta garzetta",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Pelecaniformes",
        "Family": "Ardeidae",
        "Genus": "Egretta",
        "Species": "E. garzetta"
      }
    },
    {
      "Common Name": "Little Spiderhunter",
      "Scientific Name": "Arachnothera longirostra",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Nectariniidae",
        "Genus": "Arachnothera",
        "Species": "A. longirostra"
      }
    },
    {
      "Common Name": "Loten's Sunbird",
      "Scientific Name": "Cinnyris lotenius",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Nectariniidae",
        "Genus": "Cinnyris",
        "Species": "C. lotenius"
      }
    },
    {
      "Common Name": "Malabar Barbet",
      "Scientific Name": "Psilopogon malabaricus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Megalaimidae",
        "Genus": "Psilopogon",
        "Species": "P. malabaricus"
      }
    },
    {
      "Common Name": "Malabar Lark",
      "Scientific Name": "Galerida malabarica",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Alaudidae",
        "Genus": "Galerida",
        "Species": "G. malabarica"
      }
    },
    {
      "Common Name": "Nilgiri Flowerpecker",
      "Scientific Name": "Dicaeum concolor",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Dicaeidae",
        "Genus": "Dicaeum",
        "Species": "D. concolor"
      }
    },
    {
      "Common Name": "Nilgiri Flycatcher",
      "Scientific Name": "Eumyias albicaudatus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Muscicapidae",
        "Genus": "Eumyias",
        "Species": "E. albicaudatus"
      }
    },
    {
      "Common Name": "Nilgiri Laughingthrush",
      "Scientific Name": "Montecincla cachinnans",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Leiothrichidae",
        "Genus": "Montecincla",
        "Species": "M. cachinnans"
      }
    },
    {
      "Common Name": "Oriental Skylark",
      "Scientific Name": "Alauda gulgula",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Alaudidae",
        "Genus": "Alauda",
        "Species": "A. gulgula"
      }
    },
    {
      "Common Name": "Painted Stork",
      "Scientific Name": "Mycteria leucocephala",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Ciconiiformes",
        "Family": "Ciconiidae",
        "Genus": "Mycteria",
        "Species": "M. leucocephala"
      }
    },
    {
      "Common Name": "Pale-Billed Flowerpecker",
      "Scientific Name": "Dicaeum erythrorhynchos",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Dicaeidae",
        "Genus": "Dicaeum",
        "Species": "D. erythrorhynchos"
      }
    },
    {
      "Common Name": "Pied Kingfisher",
      "Scientific Name": "Ceryle rudis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Coraciiformes",
        "Family": "Alcedinidae",
        "Genus": "Ceryle",
        "Species": "C. rudis"
      }
    },
    {
      "Common Name": "Purple Sunbird",
      "Scientific Name": "Cinnyris asiaticus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Nectariniidae",
        "Genus": "Cinnyris",
        "Species": "C. asiaticus"
      }
    },
    {
      "Common Name": "Purple-Rumped Sunbird",
      "Scientific Name": "Leptocoma zeylonica",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Nectariniidae",
        "Genus": "Leptocoma",
        "Species": "L. zeylonica"
      }
    },
    {
      "Common Name": "Red Avadavat",
      "Scientific Name": "Amandava amandava",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Estrildidae",
        "Genus": "Amandava",
        "Species": "A. amandava"
      }
    },
    {
      "Common Name": "Red-Breasted Flycatcher",
      "Scientific Name": "Ficedula parva",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Muscicapidae",
        "Genus": "Ficedula",
        "Species": "F. parva"
      }
    },
    {
      "Common Name": "Red-Rumped Swallow",
      "Scientific Name": "Cecropis daurica",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Hirundinidae",
        "Genus": "Cecropis",
        "Species": "C. daurica"
      }
    },
    {
      "Common Name": "Red-Vented Bulbul",
      "Scientific Name": "Pycnonotus cafer",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Pycnonotidae",
        "Genus": "Pycnonotus",
        "Species": "P. cafer"
      }
    },
    {
      "Common Name": "Red-Wattled Lapwing",
      "Scientific Name": "Vanellus indicus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Charadriiformes",
        "Family": "Charadriidae",
        "Genus": "Vanellus",
        "Species": "V. indicus"
      }
    },
    {
      "Common Name": "Rose-Ringed Parakeet",
      "Scientific Name": "Psittacula krameri",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Psittaciformes",
        "Family": "Psittaculidae",
        "Genus": "Psittacula",
        "Species": "P. krameri"
      }
    },
    {
      "Common Name": "Rufous Babbler",
      "Scientific Name": "Argya subrufa",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Leiothrichidae",
        "Genus": "Argya",
        "Species": "A. subrufa"
      }
    },
    {
      "Common Name": "Rufous Treepie",
      "Scientific Name": "Dendrocitta vagabunda",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Corvidae",
        "Genus": "Dendrocitta",
        "Species": "D. vagabunda"
      }
    },
    {
      "Common Name": "Rufous Woodpecker",
      "Scientific Name": "Celeus brachyurus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Picidae",
        "Genus": "Celeus",
        "Species": "C. brachyurus"
      }
    },
    {
      "Common Name": "Rufous-Bellied Woodpecker",
      "Scientific Name": "Dendrocopos hyperythrus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Picidae",
        "Genus": "Dendrocopos",
        "Species": "D. hyperythrus"
      }
    },
    {
      "Common Name": "Rufous-Tailed Lark",
      "Scientific Name": "Ammomanes phoenicura",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Alaudidae",
        "Genus": "Ammomanes",
        "Species": "A. phoenicura"
      }
    },
    {
      "Common Name": "Rusty-Tailed Flycatcher",
      "Scientific Name": "Ficedula ruficauda",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Muscicapidae",
        "Genus": "Ficedula",
        "Species": "F. ruficauda"
      }
    },
    {
      "Common Name": "Sand Lark",
      "Scientific Name": "Calandrella raytal",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Alaudidae",
        "Genus": "Calandrella",
        "Species": "C. raytal"
      }
    },
    {
      "Common Name": "Scaly-Breasted Munia",
      "Scientific Name": "Lonchura punctulata",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Estrildidae",
        "Genus": "Lonchura",
        "Species": "L. punctulata"
      }
    },
    {
      "Common Name": "Shikra",
      "Scientific Name": "Accipiter badius",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Accipitriformes",
        "Family": "Accipitridae",
        "Genus": "Accipiter",
        "Species": "A. badius"
      }
    },
    {
      "Common Name": "Siberian Rubythroat",
      "Scientific Name": "Calliope calliope",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Muscicapidae",
        "Genus": "Calliope",
        "Species": "C. calliope"
      }
    },
    {
      "Common Name": "Slaty-Blue Flycatcher",
      "Scientific Name": "Ficedula tricolor",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Muscicapidae",
        "Genus": "Ficedula",
        "Species": "F. tricolor"
      }
    },
    {
      "Common Name": "Spot-Billed Pelican",
      "Scientific Name": "Pelecanus philippensis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Pelecaniformes",
        "Family": "Pelecanidae",
        "Genus": "Pelecanus",
        "Species": "P. philippensis"
      }
    },
    {
      "Common Name": "Spotted Owlet",
      "Scientific Name": "Athene brama",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Strigiformes",
        "Family": "Strigidae",
        "Genus": "Athene",
        "Species": "A. brama"
      }
    },
    {
      "Common Name": "Stork-Billed Kingfisher",
      "Scientific Name": "Pelargopsis capensis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Coraciiformes",
        "Family": "Alcedinidae",
        "Genus": "Pelargopsis",
        "Species": "P. capensis"
      }
    },
    {
      "Common Name": "Streaked Spiderhunter",
      "Scientific Name": "Arachnothera magna",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Nectariniidae",
        "Genus": "Arachnothera",
        "Species": "A. magna"
      }
    },
    {
      "Common Name": "Streaked Weaver",
      "Scientific Name": "Ploceus manyar",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Ploceidae",
        "Genus": "Ploceus",
        "Species": "P. manyar"
      }
    },
    {
      "Common Name": "Streak-Throated Swallow",
      "Scientific Name": "Hirundo subflava",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Hirundinidae",
        "Genus": "Hirundo",
        "Species": "H. subflava"
      }
    },
    {
      "Common Name": "Streak-Throated Woodpecker",
      "Scientific Name": "Picus xanthopygaeus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Picidae",
        "Genus": "Picus",
        "Species": "P. xanthopygaeus"
      }
    },
    {
      "Common Name": "Striped Tit-Babbler",
      "Scientific Name": "Mixornis gularis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Timaliidae",
        "Genus": "Mixornis",
        "Species": "M. gularis"
      }
    },
    {
      "Common Name": "Sultan Tit",
      "Scientific Name": "Melanochlora sultanea",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Paridae",
        "Genus": "Melanochlora",
        "Species": "M. sultanea"
      }
    },
    {
      "Common Name": "Taiga Flycatcher",
      "Scientific Name": "Ficedula albicilla",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Muscicapidae",
        "Genus": "Ficedula",
        "Species": "F. albicilla"
      }
    },
    {
      "Common Name": "Tawny-Bellied Babbler",
      "Scientific Name": "Chrysomma sinense",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Leiothrichidae",
        "Genus": "Chrysomma",
        "Species": "C. sinense"
      }
    },
    {
      "Common Name": "Thick-Billed Flowerpecker",
      "Scientific Name": "Dicaeum agile",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Dicaeidae",
        "Genus": "Dicaeum",
        "Species": "D. agile"
      }
    },
    {
      "Common Name": "Ultramarine Flycatcher",
      "Scientific Name": "Ficedula superciliaris",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Muscicapidae",
        "Genus": "Ficedula",
        "Species": "F. superciliaris"
      }
    },
    {
      "Common Name": "Velvet-Fronted Nuthatch",
      "Scientific Name": "Sitta frontalis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Sittidae",
        "Genus": "Sitta",
        "Species": "S. frontalis"
      }
    },
    {
      "Common Name": "Verditer Flycatcher",
      "Scientific Name": "Eumyias thalassinus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Muscicapidae",
        "Genus": "Eumyias",
        "Species": "E. thalassinus"
      }
    },
    {
      "Common Name": "Vigors' Sunbird",
      "Scientific Name": "Aethopyga vigorsii",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Nectariniidae",
        "Genus": "Aethopyga",
        "Species": "A. vigorsii"
      }
    },
    {
      "Common Name": "White-Bellied Blue Flycatcher",
      "Scientific Name": "Cyornis pallipes",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Muscicapidae",
        "Genus": "Cyornis",
        "Species": "C. pallipes"
      }
    },
    {
      "Common Name": "White-Breasted Waterhen",
      "Scientific Name": "Amaurornis phoenicurus",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Gruiformes",
        "Family": "Rallidae",
        "Genus": "Amaurornis",
        "Species": "A. phoenicurus"
      }
    },
    {
      "Common Name": "White-Browed Fantail",
      "Scientific Name": "Rhipidura aureola",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Rhipiduridae",
        "Genus": "Rhipidura",
        "Species": "R. aureola"
      }
    },
    {
      "Common Name": "White-Browed Wagtail",
      "Scientific Name": "Motacilla maderaspatensis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Motacillidae",
        "Genus": "Motacilla",
        "Species": "M. maderaspatensis"
      }
    },
    {
      "Common Name": "White-Cheeked Barbet",
      "Scientific Name": "Psilopogon viridis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Megalaimidae",
        "Genus": "Psilopogon",
        "Species": "P. viridis"
      }
    },
    {
      "Common Name": "White-Naped Tit",
      "Scientific Name": "Machlolophus nuchalis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Paridae",
        "Genus": "Machlolophus",
        "Species": "M. nuchalis"
      }
    },
    {
      "Common Name": "White-Rumped Munia",
      "Scientific Name": "Lonchura striata",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Estrildidae",
        "Genus": "Lonchura",
        "Species": "L. striata"
      }
    },
    {
      "Common Name": "White-Spotted Fantail",
      "Scientific Name": "Rhipidura albogularis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Rhipiduridae",
        "Genus": "Rhipidura",
        "Species": "R. albogularis"
      }
    },
    {
      "Common Name": "White-Throated Kingfisher",
      "Scientific Name": "Halcyon smyrnensis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Coraciiformes",
        "Family": "Alcedinidae",
        "Genus": "Halcyon",
        "Species": "H. smyrnensis"
      }
    },
    {
      "Common Name": "Wire-Tailed Swallow",
      "Scientific Name": "Hirundo smithii",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Hirundinidae",
        "Genus": "Hirundo",
        "Species": "H. smithii"
      }
    },
    {
      "Common Name": "Yellow-Billed Babbler",
      "Scientific Name": "Argya affinis",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Leiothrichidae",
        "Genus": "Argya",
        "Species": "A. affinis"
      }
    },
    {
      "Common Name": "Yellow-Crowned Woodpecker",
      "Scientific Name": "Picus chloropoides",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Piciformes",
        "Family": "Picidae",
        "Genus": "Picus",
        "Species": "P. chloropoides"
      }
    },
    {
      "Common Name": "Yellow-Eyed Babbler",
      "Scientific Name": "Chrysomma sinense",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Passeriformes",
        "Family": "Leiothrichidae",
        "Genus": "Chrysomma",
        "Species": "C. sinense"
      }
    },
    {
      "Common Name": "Yellow-Footed Green Pigeon",
      "Scientific Name": "Treron phoenicoptera",
      "Classification": {
        "Domain": "Eukaryota",
        "Kingdom": "Animalia",
        "Phylum": "Chordata",
        "Class": "Aves",
        "Order": "Columbiformes",
        "Family": "Columbidae",
        "Genus": "Treron",
        "Species": "T. phoenicoptera"
      }
    }
];

    // NEW: Audio recording variables
    let mediaRecorder;
    let audioChunks = [];
    let audioBlob = null;
    let isRecording = false;
    let recordingStartTime;
    let timerInterval;
    let audioContext;
    let analyser;
    let animationFrame;

    // File selection handler (keeping your existing logic)
    document.getElementById('audioFile').addEventListener('change', function(e) {
        const fileName = e.target.files[0] ? e.target.files[0].name : 'No file selected';
        document.getElementById('fileName').textContent = fileName;
        document.getElementById('predictButton').disabled = !e.target.files[0];
        
        // NEW: Reset recording state when file is selected
        resetRecordingState();
        
        // NEW: Show audio preview for uploaded file
        if (e.target.files[0]) {
            const audioURL = URL.createObjectURL(e.target.files[0]);
            document.getElementById('audioPreview').src = audioURL;
            document.getElementById('audioPlayer').style.display = 'block';
        } else {
            document.getElementById('audioPlayer').style.display = 'none';
        }
    });
    
    // NEW: Record button handler
    document.getElementById('recordButton').addEventListener('click', function() {
        if (isRecording) {
            stopRecording();
        } else {
            startRecording();
        }
    });
    
    // NEW: Start recording function
    async function startRecording() {
        try {
            // Reset UI
            document.getElementById('audioFile').value = '';
            document.getElementById('fileName').textContent = 'Recording...';
            document.getElementById('audioPlayer').style.display = 'none';
            
            // Get user media
            const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
            
            // Set up audio context and analyser for visualization
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const source = audioContext.createMediaStreamSource(stream);
            analyser = audioContext.createAnalyser();
            analyser.fftSize = 256;
            source.connect(analyser);
            
            // Set up media recorder
            mediaRecorder = new MediaRecorder(stream);
            audioChunks = [];
            
            mediaRecorder.ondataavailable = function(event) {
                audioChunks.push(event.data);
            };
            
            mediaRecorder.onstop = function() {
                audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                const audioURL = URL.createObjectURL(audioBlob);
                document.getElementById('audioPreview').src = audioURL;
                document.getElementById('audioPlayer').style.display = 'block';
                document.getElementById('predictButton').disabled = false;
                
                // Stop all tracks in the stream
                stream.getTracks().forEach(track => track.stop());
            };
            
            // Start recording
            mediaRecorder.start();
            isRecording = true;
            document.getElementById('recordButton').classList.add('recording');
            document.getElementById('recordButtonText').textContent = 'Stop Recording';
            
            // Show visualizer
            document.getElementById('audioVisualizer').style.display = 'block';
            
            // Start timer
            recordingStartTime = Date.now();
            updateTimer();
            timerInterval = setInterval(updateTimer, 1000);
            
            // Start visualization
            visualize();
            
        } catch (err) {
            console.error('Error accessing microphone:', err);
            showError('Could not access microphone. Please check permissions.');
        }
    }
    
    // NEW: Stop recording function
    function stopRecording() {
        if (mediaRecorder && isRecording) {
            mediaRecorder.stop();
            isRecording = false;
            document.getElementById('recordButton').classList.remove('recording');
            document.getElementById('recordButtonText').textContent = 'Record Audio';
            document.getElementById('fileName').textContent = 'Recording captured';
            
            // Stop timer
            clearInterval(timerInterval);
            
            // Stop visualization
            cancelAnimationFrame(animationFrame);
        }
    }
    
    // NEW: Reset recording state
    function resetRecordingState() {
        isRecording = false;
        document.getElementById('recordButton').classList.remove('recording');
        document.getElementById('recordButtonText').textContent = 'Record Audio';
        document.getElementById('audioVisualizer').style.display = 'none';
        clearInterval(timerInterval);
        if (animationFrame) {
            cancelAnimationFrame(animationFrame);
        }
        audioBlob = null;
    }
    
    // NEW: Update timer function
    function updateTimer() {
        const elapsedTime = Math.floor((Date.now() - recordingStartTime) / 1000);
        const minutes = Math.floor(elapsedTime / 60).toString().padStart(2, '0');
        const seconds = (elapsedTime % 60).toString().padStart(2, '0');
        document.getElementById('recordingTimer').textContent = `${minutes}:${seconds}`;
        
        // Auto-stop after 30 seconds
        if (elapsedTime >= 30) {
            stopRecording();
        }
    }
    
    // NEW: Visualize audio function
    function visualize() {
        if (!analyser) return;
        
        const canvas = document.getElementById('visualizer');
        const canvasCtx = canvas.getContext('2d');
        const bufferLength = analyser.frequencyBinCount;
        const dataArray = new Uint8Array(bufferLength);
        
        // Set canvas size
        canvas.width = canvas.offsetWidth;
        canvas.height = canvas.offsetHeight;
        
        function draw() {
            if (!isRecording) return;
            
            animationFrame = requestAnimationFrame(draw);
            
            analyser.getByteFrequencyData(dataArray);
            
            canvasCtx.fillStyle = 'rgb(248, 249, 250)';
            canvasCtx.fillRect(0, 0, canvas.width, canvas.height);
            
            const barWidth = (canvas.width / bufferLength) * 2.5;
            let barHeight;
            let x = 0;
            
            for (let i = 0; i < bufferLength; i++) {
                barHeight = dataArray[i] / 2;
                
                const gradient = canvasCtx.createLinearGradient(0, 0, 0, canvas.height);
                gradient.addColorStop(0, '#6a11cb');
                gradient.addColorStop(1, '#2575fc');
                
                canvasCtx.fillStyle = gradient;
                canvasCtx.fillRect(x, canvas.height - barHeight, barWidth, barHeight);
                
                x += barWidth + 1;
            }
        }
        
        draw();
    }
    
    // Prediction button handler (UPDATED to handle both file uploads and recordings)
    document.getElementById('predictButton').addEventListener('click', function() {
        // Check if we have a file or recording
        if (!document.getElementById('audioFile').files[0] && !audioBlob) {
            showError('Please select an audio file or record audio first');
            return;
        }
        
        // Show loading indicator
        document.getElementById('loadingIndicator').style.display = 'block';
        document.getElementById('resultSection').style.display = 'none';
        document.getElementById('birdDetails').innerHTML = '';
        document.getElementById('scientificInfo').innerHTML = '';
        
        if (audioBlob) {
            // Send recorded audio
            sendRecordedAudio();
        } else {
            // Send uploaded file
            sendAudioFile();
        }
    });
    
    // NEW: Send recorded audio to server
    function sendRecordedAudio() {
        // Convert blob to base64
        const reader = new FileReader();
        reader.readAsDataURL(audioBlob);
        reader.onloadend = function() {
            const base64Audio = reader.result;
            
            // Send to server
            fetch('/predict_voice', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    audio: base64Audio
                })
            })
            .then(handlePredictionResponse)
            .catch(handlePredictionError);
        };
    }
    
    // NEW: Send audio file to server
    function sendAudioFile() {
        const formData = new FormData();
        formData.append('file', document.getElementById('audioFile').files[0]);
        
        // Send to server
        fetch('/predict_voice', {
            method: 'POST',
            body: formData
        })
        .then(handlePredictionResponse)
        .catch(handlePredictionError);
    }
    
    // NEW: Handle prediction response
    function handlePredictionResponse(response) {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.json().then(data => {
            // Hide loading indicator
            document.getElementById('loadingIndicator').style.display = 'none';
            
            // Display prediction results
            displayPredictionResults(data);
            
            // Fetch and display Wikipedia info
            fetchWikipediaData(data.prediction);
            
            // Display scientific classification from JSON
            displayScientificInfo(data.prediction);
            
            // Show result section
            document.getElementById('resultSection').style.display = 'block';
        });
    }
    
    // NEW: Handle prediction error
    function handlePredictionError(error) {
        console.error('Error:', error);
        document.getElementById('loadingIndicator').style.display = 'none';
        showError('An error occurred while processing the audio. Please try again.');
    }

    // Display prediction results (keeping your existing function)
    function displayPredictionResults(data) {
        const birdName = data.prediction;
        document.getElementById('predictionResult').textContent = birdName;
        const confidencePercent = Math.round(data.confidence * 100);
        document.getElementById('confidenceValue').textContent = confidencePercent + '%';
        document.getElementById('confidenceLevel').style.width = confidencePercent + '%';
        
        // Display other predictions
        const allPredictionsDiv = document.getElementById('allPredictions');
        allPredictionsDiv.innerHTML = '';
        
        const predictionsArray = Object.entries(data.all_predictions)
            .map(([name, value]) => ({ name, value: Math.round(value * 100) }))
            .sort((a, b) => b.value - a.value);
        
        predictionsArray.slice(0, 6).forEach(pred => {
            if (pred.name === data.prediction) return;
            
            const predElement = document.createElement('div');
            predElement.className = 'prediction-item d-flex justify-content-between py-2';
            
            const nameElement = document.createElement('span');
            nameElement.className = 'prediction-name fw-bold';
            nameElement.textContent = pred.name;
            
            const valueElement = document.createElement('span');
            valueElement.className = 'prediction-value text-muted';
            valueElement.textContent = pred.value + '%';
            
            predElement.appendChild(nameElement);
            predElement.appendChild(valueElement);
            allPredictionsDiv.appendChild(predElement);
        });
    }

    // Fetch Wikipedia data (keeping your existing function)
    function fetchWikipediaData(birdName) {
        const birdDetailsDiv = document.getElementById('birdDetails');
        
        // Show loading state
        birdDetailsDiv.innerHTML = `
            <div style="width:100%; text-align:center; padding:2rem;">
                <div class="spinner"></div>
                <p>Loading bird information from Wikipedia...</p>
            </div>
        `;
        
        // First search for the correct page
        fetch(`https://en.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(birdName)}&format=json&origin=*`)
            .then(response => response.json())
            .then(searchData => {
                if (searchData.query.search.length === 0) {
                    throw new Error('No Wikipedia page found');
                }
                
                // Get the most relevant page
                const pageTitle = searchData.query.search[0].title;
                
                // Fetch page content and image
                return Promise.all([
                    fetch(`https://en.wikipedia.org/w/api.php?action=query&prop=extracts|pageimages&exintro=true&explaintext=true&pithumbsize=500&titles=${encodeURIComponent(pageTitle)}&format=json&origin=*`),
                    fetch(`https://en.wikipedia.org/w/api.php?action=query&prop=pageimages&pithumbsize=500&titles=${encodeURIComponent(pageTitle)}&format=json&origin=*`)
                ]);
            })
            .then(responses => Promise.all(responses.map(res => res.json())))
            .then(([contentData, imageData]) => {
                const pages = contentData.query.pages;
                const pageId = Object.keys(pages)[0];
                
                if (pageId === '-1') {
                    throw new Error('No Wikipedia page found');
                }
                
                const page = pages[pageId];
                const extract = page.extract;
                const imagePages = imageData.query.pages;
                const imagePage = imagePages[pageId];
                const imageUrl = imagePage.thumbnail ? imagePage.thumbnail.source : null;
                
                // Display the information
                birdDetailsDiv.innerHTML = `
                    <div class="bird-image-container">
                        ${imageUrl ? `<img src="${imageUrl}" alt="${birdName}" class="bird-image">` : 
                          `<div style="background:#f1f1f1; height:300px; display:flex; align-items:center; justify-content:center; border-radius:12px;">
                              <p>No image available</p>
                          </div>`}
                    </div>
                    <div class="bird-info">
                        <h3>About ${birdName}</h3>
                        <div class="bird-description">
                            ${extract ? extract.split('\n')[0] + (extract.split('\n').length > 1 ? '...' : '') : 
                              'No description available from Wikipedia.'}
                        </div>
                        <div class="wiki-attribution">
                            Source: <a href="https://en.wikipedia.org/wiki/${encodeURIComponent(page.title.replace(/ /g, '_'))}" 
                                       target="_blank" 
                                       rel="noopener noreferrer"
                                       class="wiki-link">Wikipedia</a>
                        </div>
                    </div>
                `;
            })
            .catch(error => {
                console.error('Wikipedia fetch error:', error);
                birdDetailsDiv.innerHTML = `
                    <div class="alert alert-warning w-100">
                        Couldn't fetch additional information from Wikipedia. 
                        <a href="https://en.wikipedia.org/wiki/Special:Search?search=${encodeURIComponent(birdName)}" 
                           target="_blank" 
                           rel="noopener noreferrer"
                           class="alert-link">Search Wikipedia manually</a>.
                    </div>
                `;
            });
    }

    // Display scientific classification from JSON data (keeping your existing function)
    function displayScientificInfo(birdName) {
        const scientificInfoDiv = document.getElementById('scientificInfo');
        
        // Find the bird in our JSON data
        const birdInfo = birdData.find(bird => bird["Common Name"] === birdName);
        
        if (birdInfo) {
            scientificInfoDiv.innerHTML = `
                <h3>Scientific Classification</h3>
                <p><strong>Scientific Name:</strong> <em>${birdInfo["Scientific Name"]}</em></p>
                <table class="classification-table">
                    <tr>
                        <th>Classification</th>
                        <th>Value</th>
                    </tr>
                    ${Object.entries(birdInfo.Classification).map(([key, value]) => `
                        <tr>
                            <td><strong>${key}</strong></td>
                            <td>${value}</td>
                        </tr>
                    `).join('')}
                </table>
            `;
        } else {
            scientificInfoDiv.innerHTML = `
                <div class="alert alert-info">
                    No additional scientific information available for ${birdName}.
                </div>
            `;
        }
    }

    // Show error message (keeping your existing function)
    function showError(message) {
        const errorDiv = document.createElement('div');
        errorDiv.className = 'alert alert-danger mt-3';
        errorDiv.textContent = message;
        errorDiv.style.animation = 'fadeIn 0.5s';
        document.querySelector('.upload-card').appendChild(errorDiv);
        
        setTimeout(() => {
            errorDiv.style.animation = 'fadeOut 0.5s';
            setTimeout(() => errorDiv.remove(), 500);
        }, 3000);
    }
</script>
{% endblock %}
